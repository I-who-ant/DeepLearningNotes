"""
GPU vs CPU æ·±åº¦è§£æ: ä¸ºä»€ä¹ˆGPUè®­ç»ƒè¿™ä¹ˆå¿«?

è¿™ä¸ªæ–‡æ¡£è¯¦ç»†è§£é‡Šäº†GPUç›¸æ¯”CPUåœ¨æ·±åº¦å­¦ä¹ è®­ç»ƒä¸­å¿«10-100å€çš„åŸå› 
"""

import numpy as np
import matplotlib.pyplot as plt
import time


# ============================================================
# 1. æ ¸å¿ƒåŸç†: å¹¶è¡Œè®¡ç®—
# ============================================================
def explain_parallelism():
    """è§£é‡ŠCPUå’ŒGPUçš„å¹¶è¡Œèƒ½åŠ›å·®å¼‚"""
    print("=" * 70)
    print("ğŸ’¡ æ ¸å¿ƒåŸç†: å¹¶è¡Œè®¡ç®—")
    print("=" * 70)

    print("""
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CPU vs GPU æ¶æ„å¯¹æ¯”                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€CPU - å°‘è€Œå¼ºçš„æ ¸å¿ƒã€‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Core 1  â”‚  Core 2  â”‚  Core 4  â”‚  Core 8   â”‚
â”‚  (å¼ºå¤§)  â”‚  (å¼ºå¤§)  â”‚  (å¼ºå¤§)  â”‚  (å¼ºå¤§)    â”‚
â”‚  å¤æ‚æŒ‡ä»¤â”‚  å¤æ‚æŒ‡ä»¤â”‚  å¤æ‚æŒ‡ä»¤â”‚  å¤æ‚æŒ‡ä»¤  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ç‰¹ç‚¹:
  - æ ¸å¿ƒæ•°é‡: 4-16ä¸ª (æ™®é€šCPU)
  - æ¯ä¸ªæ ¸å¿ƒ: éå¸¸å¼ºå¤§,æ“…é•¿å¤æ‚é€»è¾‘
  - é€‚åˆ: é¡ºåºæ‰§è¡Œ,å¤æ‚åˆ†æ”¯åˆ¤æ–­

ã€GPU - å¤šè€Œç®€çš„æ ¸å¿ƒã€‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Core 1 â”‚ Core 2 â”‚ Core 3 â”‚ Core 4 â”‚ ... â”‚ Core 5000 â”‚ Core 10000 â”‚
â”‚ (ç®€å•) â”‚ (ç®€å•) â”‚ (ç®€å•) â”‚ (ç®€å•) â”‚ ... â”‚  (ç®€å•)   â”‚  (ç®€å•)    â”‚
â”‚ ç®€å•è¿ç®—â”‚ç®€å•è¿ç®—â”‚ç®€å•è¿ç®—â”‚ç®€å•è¿ç®—â”‚ ... â”‚  ç®€å•è¿ç®— â”‚  ç®€å•è¿ç®—   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ç‰¹ç‚¹:
  - æ ¸å¿ƒæ•°é‡: æ•°åƒä¸ª (å¦‚RTX 4090æœ‰16384ä¸ªCUDAæ ¸å¿ƒ)
  - æ¯ä¸ªæ ¸å¿ƒ: ç®€å•,åªåšåŸºç¡€æ•°å­¦è¿ç®—
  - é€‚åˆ: å¤§é‡ç›¸åŒçš„ç®€å•è®¡ç®— (çŸ©é˜µè¿ç®—!)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å½¢è±¡æ¯”å–»                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CPU = 8ä¸ªåšå£«
  - äººæ•°å°‘,ä½†æ¯ä¸ªäººéƒ½å¾ˆèªæ˜
  - æ“…é•¿è§£å†³å¤æ‚é—®é¢˜
  - åšç®€å•é‡å¤å·¥ä½œæ•ˆç‡ä½

GPU = 10000ä¸ªå°å­¦ç”Ÿ
  - äººæ•°å¤š,ä½†æ¯ä¸ªäººåªä¼šç®€å•è®¡ç®—
  - æ“…é•¿å¤§é‡ç®€å•é‡å¤å·¥ä½œ
  - åŒæ—¶è®¡ç®—10000ä¸ªä¹˜æ³• â†’ è¶…å¿«!

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ä»»åŠ¡å¯¹æ¯”                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä»»åŠ¡1: è®¡ç®— 1000Ã—1000 çš„ä¸¤ä¸ªçŸ©é˜µç›¸ä¹˜
  - éœ€è¦è®¡ç®—: 1000Ã—1000Ã—1000 = 10äº¿æ¬¡ä¹˜æ³•

  CPU (8æ ¸):
    - æ¯ä¸ªæ ¸å¿ƒè´Ÿè´£ 1.25äº¿æ¬¡è®¡ç®—
    - é¡ºåºæ‰§è¡Œ: å¾ˆæ…¢

  GPU (10000æ ¸):
    - æ¯ä¸ªæ ¸å¿ƒåªéœ€ 10ä¸‡æ¬¡è®¡ç®—
    - å¹¶è¡Œæ‰§è¡Œ: è¶…å¿«!
    - é€Ÿåº¦æå‡: çº¦1000å€

ä»»åŠ¡2: ç¥ç»ç½‘ç»œå‰å‘ä¼ æ’­
  - æ¯å±‚éƒ½æ˜¯çŸ©é˜µä¹˜æ³•
  - éœ€è¦è®¡ç®—æ•°ç™¾ä¸‡æ¬¡ä¹˜æ³•

  CPU: ä¸€ä¸ªä¸€ä¸ªç®— â†’ æ…¢
  GPU: åŒæ—¶ç®—æ•°åƒä¸ª â†’ å¿«
""")


# ============================================================
# 2. å®é™…æ¼”ç¤º: CPU vs GPU çŸ©é˜µä¹˜æ³•é€Ÿåº¦
# ============================================================
def demo_matrix_multiplication_speed():
    """æ¼”ç¤ºCPUå’ŒGPUåœ¨çŸ©é˜µä¹˜æ³•ä¸Šçš„é€Ÿåº¦å·®å¼‚"""
    print("\n" + "=" * 70)
    print("ğŸ”¬ å®é™…æ¼”ç¤º: çŸ©é˜µä¹˜æ³•é€Ÿåº¦å¯¹æ¯”")
    print("=" * 70)

    sizes = [100, 500, 1000, 2000]
    cpu_times = []

    print("\nä½¿ç”¨NumPy (CPU) è¿›è¡ŒçŸ©é˜µä¹˜æ³•:")
    print("-" * 70)

    for size in sizes:
        # åˆ›å»ºéšæœºçŸ©é˜µ
        A = np.random.randn(size, size)
        B = np.random.randn(size, size)

        # CPUè®¡ç®—
        start = time.time()
        C = np.dot(A, B)
        cpu_time = time.time() - start
        cpu_times.append(cpu_time)

        ops = size * size * size  # ä¹˜æ³•æ¬¡æ•°
        gflops = (ops / cpu_time) / 1e9  # åäº¿æ¬¡æµ®ç‚¹è¿ç®—æ¯ç§’

        print(f"çŸ©é˜µå¤§å°: {size}Ã—{size}")
        print(f"  è®¡ç®—é‡: {ops/1e6:.1f} ç™¾ä¸‡æ¬¡ä¹˜æ³•")
        print(f"  CPUè€—æ—¶: {cpu_time*1000:.2f} æ¯«ç§’")
        print(f"  CPUæ€§èƒ½: {gflops:.2f} GFLOPS")
        print()

    print("\nğŸ’¡ è¯´æ˜:")
    print("  - GFLOPS = æ¯ç§’åäº¿æ¬¡æµ®ç‚¹è¿ç®— (è¶Šé«˜è¶Šå¥½)")
    print("  - æ™®é€šCPU: 10-50 GFLOPS")
    print("  - é«˜ç«¯GPU: 10000-40000 GFLOPS (å¿«100-1000å€!)")


# ============================================================
# 3. æ·±åº¦å­¦ä¹ ä¸­çš„è®¡ç®—ç‰¹ç‚¹
# ============================================================
def explain_deep_learning_operations():
    """è§£é‡Šæ·±åº¦å­¦ä¹ è®¡ç®—ä¸ºä»€ä¹ˆé€‚åˆGPU"""
    print("\n" + "=" * 70)
    print("ğŸ§  æ·±åº¦å­¦ä¹ è®¡ç®—ç‰¹ç‚¹")
    print("=" * 70)

    print("""
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ç¥ç»ç½‘ç»œè®­ç»ƒä¸­çš„è®¡ç®—ç±»å‹                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. çŸ©é˜µä¹˜æ³• (å 90%ä»¥ä¸Šçš„è®¡ç®—é‡)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ è¾“å…¥çŸ©é˜µ Ã— æƒé‡çŸ©é˜µ = è¾“å‡ºçŸ©é˜µ   â”‚
   â”‚ [batch, in] Ã— [in, out] = [batch, out] â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   ä¾‹å¦‚: CIFAR-10 CNNçš„ä¸€ä¸ªå…¨è¿æ¥å±‚
   è¾“å…¥: [64, 2048]  (64ä¸ªæ ·æœ¬,æ¯ä¸ª2048ç»´)
   æƒé‡: [2048, 10]   (2048ä¸ªè¾“å…¥,10ä¸ªç±»åˆ«)
   è¾“å‡º: [64, 10]     (64ä¸ªæ ·æœ¬,æ¯ä¸ª10ä¸ªåˆ†æ•°)

   è®¡ç®—é‡: 64 Ã— 2048 Ã— 10 = 1,310,720 æ¬¡ä¹˜æ³•

   CPU (8æ ¸): æ¯ä¸ªæ ¸å¿ƒç®— 163,840 æ¬¡ â†’ æ…¢
   GPU (10000æ ¸): æ¯ä¸ªæ ¸å¿ƒç®— 131 æ¬¡ â†’ å¿«!

2. å·ç§¯è¿ç®— (ä¹Ÿæ˜¯å¤§é‡ä¹˜æ³•)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ å›¾åƒ * å·ç§¯æ ¸ = ç‰¹å¾å›¾           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   ä¾‹å¦‚: ä¸€ä¸ªå·ç§¯å±‚
   è¾“å…¥: [64, 3, 32, 32]   (64å¼ 32Ã—32çš„RGBå›¾ç‰‡)
   å·ç§¯æ ¸: [64, 3, 3, 3]   (64ä¸ª3Ã—3çš„æ»¤æ³¢å™¨)

   è®¡ç®—é‡: 64 Ã— 3 Ã— 32 Ã— 32 Ã— 64 Ã— 3 Ã— 3 = 113,246,208 æ¬¡ä¹˜æ³•

   GPUå¹¶è¡Œè®¡ç®— â†’ è¶…å¿«!

3. æ¿€æ´»å‡½æ•° (ç®€å•çš„é€å…ƒç´ è¿ç®—)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ReLU: max(0, x)                  â”‚
   â”‚ Sigmoid: 1/(1+e^-x)              â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   æ¯ä¸ªå…ƒç´ ç‹¬ç«‹è®¡ç®— â†’ å®Œç¾å¹¶è¡Œ!

4. åå‘ä¼ æ’­ (åˆæ˜¯å¤§é‡çŸ©é˜µä¹˜æ³•)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ æ¢¯åº¦ = è¯¯å·® Ã— æ¿€æ´»å€¼è½¬ç½®         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   åˆæ˜¯çŸ©é˜µä¹˜æ³• â†’ GPUåŠ é€Ÿ!

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ€»ç»“                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¥ç»ç½‘ç»œè®­ç»ƒçš„ç‰¹ç‚¹:
  âœ… å¤§é‡ç®€å•çš„æ•°å­¦è¿ç®— (åŠ æ³•ã€ä¹˜æ³•)
  âœ… é«˜åº¦å¹¶è¡Œ (æ•°ç™¾ä¸‡ä¸ªç‹¬ç«‹è®¡ç®—)
  âœ… é‡å¤æ‰§è¡Œç›¸åŒæ“ä½œ

â†’ å®Œç¾åŒ¹é…GPUçš„ä¼˜åŠ¿!

CPUçš„ä¼˜åŠ¿:
  âŒ å¤æ‚é€»è¾‘ (if-elseåˆ†æ”¯)
  âŒ é¡ºåºæ‰§è¡Œ
  âŒ å†…å­˜ç®¡ç†

â†’ åœ¨æ·±åº¦å­¦ä¹ ä¸­ç”¨ä¸ä¸Š
""")


# ============================================================
# 4. å…·ä½“æ•°å­—å¯¹æ¯”
# ============================================================
def show_concrete_numbers():
    """å±•ç¤ºå…·ä½“çš„æ€§èƒ½æ•°å­—"""
    print("\n" + "=" * 70)
    print("ğŸ“Š å…·ä½“æ€§èƒ½æ•°å­—å¯¹æ¯”")
    print("=" * 70)

    print("""
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 å…¸å‹è®¾å¤‡æ€§èƒ½å¯¹æ¯”                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è®¾å¤‡ç±»å‹              æ ¸å¿ƒæ•°    æµ®ç‚¹æ€§èƒ½(GFLOPS)  æ˜¾å­˜/å†…å­˜    ä»·æ ¼
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Intel i7-12700       8æ ¸      ~50               32GB        Â¥2000
AMD Ryzen 9 5900X    12æ ¸     ~100              64GB        Â¥3000
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NVIDIA GTX 1660      1408æ ¸   ~5000             6GB         Â¥1500
NVIDIA RTX 3060      3584æ ¸   ~13000            12GB        Â¥2500
NVIDIA RTX 4070      5888æ ¸   ~29000            12GB        Â¥4500
NVIDIA RTX 4090      16384æ ¸  ~83000            24GB        Â¥13000
NVIDIA A100          6912æ ¸   ~156000           40GB        Â¥70000
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

æ€§èƒ½å€æ•°:
  - RTX 3060 vs i7-12700: 260å€ (13000/50)
  - RTX 4090 vs i7-12700: 1660å€ (83000/50)
  - A100 vs i7-12700: 3120å€ (156000/50)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            å®é™…è®­ç»ƒæ—¶é—´å¯¹æ¯” (ResNet-50 on ImageNet)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è®¾å¤‡              å•ä¸ªepochæ—¶é—´    å®Œæˆ90ä¸ªepoch
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Intel i7 (CPU)    ~50 å°æ—¶         ~187 å¤© (åŠå¹´!)
RTX 3060 (GPU)    ~3 å°æ—¶          ~11 å¤©
RTX 4090 (GPU)    ~1 å°æ—¶          ~4 å¤©
8Ã—A100 (GPUé›†ç¾¤)  ~10 åˆ†é’Ÿ         ~15 å°æ—¶
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â†’ GPUä¸æ˜¯å¿«ä¸€ç‚¹ç‚¹,è€Œæ˜¯å¿«å‡ ç™¾å€!

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 ä½ çš„ç¯å¢ƒ (8æ ¸CPU)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¼°ç®—:
  - CIFAR-10è®­ç»ƒ SimpleCNN (å°æ¨¡å‹)
    - CPU: 1ä¸ªepoch ~30-60ç§’
    - RTX 3060: 1ä¸ªepoch ~2-3ç§’ (å¿«15-20å€)
    - RTX 4090: 1ä¸ªepoch ~1ç§’ (å¿«30-60å€)

  - å¦‚æœè®­ç»ƒ100ä¸ªepoch:
    - CPU: 50-100åˆ†é’Ÿ
    - RTX 3060: 3-5åˆ†é’Ÿ
    - RTX 4090: 1-2åˆ†é’Ÿ
""")


# ============================================================
# 5. ä¸ºä»€ä¹ˆä¸æ˜¯æ‰€æœ‰ä»»åŠ¡éƒ½ç”¨GPU?
# ============================================================
def explain_gpu_limitations():
    """è§£é‡ŠGPUçš„å±€é™æ€§"""
    print("\n" + "=" * 70)
    print("âš ï¸ GPUä¸æ˜¯ä¸‡èƒ½çš„")
    print("=" * 70)

    print("""
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              GPUçš„å±€é™æ€§                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. åªæ“…é•¿å¹¶è¡Œè®¡ç®—
   âœ… é€‚åˆ: çŸ©é˜µä¹˜æ³•,å·ç§¯,é€å…ƒç´ è¿ç®—
   âŒ ä¸é€‚åˆ: å¤æ‚if-elseé€»è¾‘,é€’å½’,åˆ†æ”¯å¤šçš„ä»£ç 

2. æ•°æ®ä¼ è¾“å¼€é”€
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    ä¼ è¾“    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   CPU    â”‚  â†â”€â”€â”€â”€â†’   â”‚   GPU    â”‚
   â”‚  å†…å­˜    â”‚   (æ…¢!)   â”‚  æ˜¾å­˜    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   - CPUâ†’GPUä¼ è¾“: æ…¢ (~10 GB/s)
   - GPUè®¡ç®—: å¿« (~83000 GFLOPS)

   å¦‚æœæ•°æ®å°,ä¼ è¾“æ—¶é—´>è®¡ç®—æ—¶é—´ â†’ GPUåè€Œæ…¢!

3. æ˜¾å­˜é™åˆ¶
   - CPUå†…å­˜: 32GB, 64GBç”šè‡³æ›´å¤š
   - GPUæ˜¾å­˜: 6GB, 12GB, 24GB (å¾ˆè´µ!)

   æ¨¡å‹å¤ªå¤§ â†’ è£…ä¸ä¸‹ â†’ æ— æ³•è®­ç»ƒ

4. ç¼–ç¨‹å¤æ‚åº¦
   - CPU: æ™®é€šPythonä»£ç 
   - GPU: éœ€è¦ç‰¹æ®Šä¼˜åŒ– (å¥½åœ¨PyTorchå·²ç»å¸®æˆ‘ä»¬åšäº†)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ä»€ä¹ˆæ—¶å€™ç”¨CPU,ä»€ä¹ˆæ—¶å€™ç”¨GPU?                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä½¿ç”¨CPUçš„åœºæ™¯:
  âœ… å­¦ä¹ åŸºç¡€çŸ¥è¯† (ä½ ç°åœ¨!)
  âœ… å°è§„æ¨¡å®éªŒ (å‡ åƒä¸ªæ ·æœ¬)
  âœ… è°ƒè¯•ä»£ç 
  âœ… æ•°æ®é¢„å¤„ç†
  âœ… æ²¡æœ‰GPUçš„ç¯å¢ƒ

ä½¿ç”¨GPUçš„åœºæ™¯:
  âœ… å¤§è§„æ¨¡è®­ç»ƒ (æ•°ä¸‡ã€æ•°ç™¾ä¸‡æ ·æœ¬)
  âœ… å¤§æ¨¡å‹ (å‚æ•°é‡>1000ä¸‡)
  âœ… æ—¶é—´ç´§è¿«çš„é¡¹ç›®
  âœ… éœ€è¦å¤šæ¬¡å®éªŒè°ƒå‚

æ··åˆä½¿ç”¨:
  ğŸ’¡ CPUè´Ÿè´£: æ•°æ®åŠ è½½ã€é¢„å¤„ç†
  ğŸ’¡ GPUè´Ÿè´£: æ¨¡å‹è®­ç»ƒã€æ¨ç†

  è¿™å°±æ˜¯ä¸ºä»€ä¹ˆDataLoaderæœ‰num_workerså‚æ•°:
  DataLoader(dataset, num_workers=4)  # CPUå¤šè¿›ç¨‹åŠ è½½æ•°æ®
  â†’ CPUå¤„ç†æ•°æ®,GPUè®­ç»ƒæ¨¡å‹,å®Œç¾é…åˆ!
""")


# ============================================================
# 6. å¯è§†åŒ–å¯¹æ¯”
# ============================================================
def visualize_comparison():
    """å¯è§†åŒ–CPU vs GPUæ€§èƒ½å¯¹æ¯”"""
    print("\n" + "=" * 70)
    print("ğŸ“ˆ ç”Ÿæˆæ€§èƒ½å¯¹æ¯”å›¾è¡¨...")
    print("=" * 70)

    # åˆ›å»ºå¯¹æ¯”å›¾
    fig, axes = plt.subplots(2, 2, figsize=(14, 10))
    fig.suptitle('CPU vs GPU æ€§èƒ½å¯¹æ¯”', fontsize=16, fontweight='bold')

    # å›¾1: æ ¸å¿ƒæ•°é‡å¯¹æ¯”
    devices = ['Intel i7\n(CPU)', 'RTX 3060\n(GPU)', 'RTX 4090\n(GPU)']
    cores = [8, 3584, 16384]
    colors = ['#3498db', '#e74c3c', '#e74c3c']

    axes[0, 0].bar(devices, cores, color=colors)
    axes[0, 0].set_ylabel('æ ¸å¿ƒæ•°é‡', fontsize=12)
    axes[0, 0].set_title('1. æ ¸å¿ƒæ•°é‡å¯¹æ¯”', fontsize=12, fontweight='bold')
    axes[0, 0].set_yscale('log')
    for i, v in enumerate(cores):
        axes[0, 0].text(i, v, str(v), ha='center', va='bottom')

    # å›¾2: è®¡ç®—æ€§èƒ½å¯¹æ¯” (GFLOPS)
    gflops = [50, 13000, 83000]

    axes[0, 1].bar(devices, gflops, color=colors)
    axes[0, 1].set_ylabel('æµ®ç‚¹æ€§èƒ½ (GFLOPS)', fontsize=12)
    axes[0, 1].set_title('2. è®¡ç®—æ€§èƒ½å¯¹æ¯”', fontsize=12, fontweight='bold')
    axes[0, 1].set_yscale('log')

    # æ·»åŠ åŠ é€Ÿæ¯”æ ‡ç­¾
    axes[0, 1].text(1, gflops[1], f'{gflops[1]/gflops[0]:.0f}x',
                    ha='center', va='bottom', color='red', fontweight='bold')
    axes[0, 1].text(2, gflops[2], f'{gflops[2]/gflops[0]:.0f}x',
                    ha='center', va='bottom', color='red', fontweight='bold')

    # å›¾3: è®­ç»ƒæ—¶é—´å¯¹æ¯” (åˆ†é’Ÿ)
    devices_train = ['CPU\n(i7)', 'GPU\n(RTX 3060)', 'GPU\n(RTX 4090)']
    train_times = [75, 4, 1.5]  # 100ä¸ªepochçš„æ—¶é—´(åˆ†é’Ÿ)

    bars = axes[1, 0].barh(devices_train, train_times, color=colors)
    axes[1, 0].set_xlabel('è®­ç»ƒæ—¶é—´ (åˆ†é’Ÿ, 100 epochs)', fontsize=12)
    axes[1, 0].set_title('3. CIFAR-10è®­ç»ƒæ—¶é—´å¯¹æ¯”', fontsize=12, fontweight='bold')
    axes[1, 0].invert_yaxis()

    for i, (bar, time) in enumerate(zip(bars, train_times)):
        axes[1, 0].text(time, i, f' {time}åˆ†é’Ÿ', va='center')

    # å›¾4: çŸ©é˜µä¹˜æ³•æ€§èƒ½éšå¤§å°å˜åŒ–
    matrix_sizes = [100, 500, 1000, 2000, 3000]
    cpu_times_sim = [0.001, 0.125, 1.0, 8.0, 27.0]  # æ¨¡æ‹Ÿæ•°æ®
    gpu_times_sim = [0.0001, 0.001, 0.008, 0.064, 0.216]  # æ¨¡æ‹Ÿæ•°æ®

    axes[1, 1].plot(matrix_sizes, cpu_times_sim, 'o-', label='CPU', linewidth=2, markersize=8)
    axes[1, 1].plot(matrix_sizes, gpu_times_sim, 's-', label='GPU', linewidth=2, markersize=8)
    axes[1, 1].set_xlabel('çŸ©é˜µå¤§å°', fontsize=12)
    axes[1, 1].set_ylabel('è®¡ç®—æ—¶é—´ (ç§’)', fontsize=12)
    axes[1, 1].set_title('4. çŸ©é˜µä¹˜æ³•æ€§èƒ½', fontsize=12, fontweight='bold')
    axes[1, 1].set_yscale('log')
    axes[1, 1].legend(fontsize=10)
    axes[1, 1].grid(True, alpha=0.3)

    plt.tight_layout()

    # ä¿å­˜å›¾ç‰‡
    output_path = 'artifacts/cpu_gpu_comparison.png'
    import os
    os.makedirs('artifacts', exist_ok=True)
    plt.savefig(output_path, dpi=150, bbox_inches='tight')
    print(f"\nâœ… å¯¹æ¯”å›¾è¡¨å·²ä¿å­˜åˆ°: {output_path}")
    plt.close()


# ============================================================
# 7. ä¸»å‡½æ•°
# ============================================================
def main():
    """ä¸»å‡½æ•°"""
    print("=" * 70)
    print("ğŸš€ GPU vs CPU æ·±åº¦è§£æ")
    print("=" * 70)
    print("\nè¿™ä¸ªç¨‹åºå°†è¯¦ç»†è§£é‡Šä¸ºä»€ä¹ˆGPUåœ¨æ·±åº¦å­¦ä¹ ä¸­æ¯”CPUå¿«é‚£ä¹ˆå¤š\n")

    # 1. è§£é‡Šå¹¶è¡Œè®¡ç®—åŸç†
    explain_parallelism()

    # 2. å®é™…æ¼”ç¤ºçŸ©é˜µä¹˜æ³•é€Ÿåº¦
    demo_matrix_multiplication_speed()

    # 3. è§£é‡Šæ·±åº¦å­¦ä¹ è®¡ç®—ç‰¹ç‚¹
    explain_deep_learning_operations()

    # 4. å±•ç¤ºå…·ä½“æ•°å­—
    show_concrete_numbers()

    # 5. è§£é‡ŠGPUå±€é™æ€§
    explain_gpu_limitations()

    # 6. å¯è§†åŒ–å¯¹æ¯”
    visualize_comparison()

    print("\n" + "=" * 70)
    print("âœ… æ‰€æœ‰è§£é‡Šå®Œæˆ!")
    print("=" * 70)

    print("""
ğŸ¯ æ ¸å¿ƒè¦ç‚¹æ€»ç»“:

1. GPUæœ‰æ•°åƒä¸ªç®€å•æ ¸å¿ƒ vs CPUåªæœ‰å‡ ä¸ªå¤æ‚æ ¸å¿ƒ
   â†’ GPUå¹¶è¡Œèƒ½åŠ›å¼º

2. æ·±åº¦å­¦ä¹  = å¤§é‡ç®€å•é‡å¤çš„çŸ©é˜µä¹˜æ³•
   â†’ å®Œç¾åŒ¹é…GPUä¼˜åŠ¿

3. GPUæµ®ç‚¹æ€§èƒ½æ˜¯CPUçš„100-1000å€
   â†’ è®­ç»ƒå¿«100-1000å€

4. ä½†GPUä¸æ“…é•¿å¤æ‚é€»è¾‘
   â†’ æ•°æ®é¢„å¤„ç†è¿˜æ˜¯ç”¨CPU

5. ä½ ç°åœ¨ç”¨CPUå­¦ä¹ å®Œå…¨OK
   â†’ å…ˆå­¦ä¼šåŸç†,éœ€è¦æ—¶å†ç”¨GPUåŠ é€Ÿ

ğŸ’¡ è®°ä½:
   CPU = å°‘æ•°åšå£« (èªæ˜ä½†å°‘)
   GPU = å¤§é‡å°å­¦ç”Ÿ (ç®€å•ä½†å¤š)

   æ·±åº¦å­¦ä¹  = å¤§é‡ç®€å•è®¡ç®—
   â†’ GPU = ç†æƒ³å·¥å…·!
""")


if __name__ == '__main__':
    main()
